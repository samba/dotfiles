#!/bin/bash


main () {
  local w=10
  while getopts :t: Opt; do
    case $Opt in
      t) w=$OPTARG;; # seconds to wait between checks
    esac
  done
  shift $(( OPTIND - 1 ))

  # start dd and get the PID
  dd $@ &
  p=$!

  # watch the progress and wait a bit.
  while kill -USR1 ${p}; do
    sleep $w
  done

  wait # make sure we don't leave other child processes hanging

}

main $@

